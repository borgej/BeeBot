@model YTBot.Models.KillStat

@{
    Layout = null;
}
<!DOCTYPE html>
<html>
<head>
    <title>YTBot - Killstats</title>
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @Scripts.Render("~/bundles/signalr")

    <script src="https://cdn.jsdelivr.net/npm/gasparesganga-jquery-loading-overlay@2.0.2/dist/loadingoverlay.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <script src="~/Scripts/Signalr.js"></script>
    <style>
        body {
            font-size: 30px !important;
            color: white !important;
            background-color: chartreuse;
        }

        html {
            background-color: chartreuse;
        }
    </style>
</head>
<body>
<div class="container-fluid text-left">
    <div class="col-12 text-left mt-2 ml-0">
        <div class="col-12 kills">
            <span id="killNr">0</span><span class="killText"> Kills</span>
        </div>
        <div class="col-12 squadKills mt-0">
            <span id="squadNr">0</span><span class="squadText"> Squad kills</span>
        </div>
        <div class="col-12 deaths mt-0">
            <span id="deathNr">0</span><span class="deathText"> Deaths</span>
        </div>
    </div>
</div>
</body>
</html>

<script type="text/javascript">
    var twitchHub = $.connection.twitchHub;

    (function () {
        $.connection.hub.logging = true;
        // Start the hub
        $.connection.hub.start().done(function () {
            twitchHub.server.pollKillStats();

            setInterval(function () {
                    twitchHub.server.pollKillStats();
                },
                15000);
        });

        twitchHub.client.UpdateKillStats = function (ret) {
            updateStats(ret);
        };

        twitchHub.client.onconnected = function () {
            console.log("connected...");
            $(".console").append("Connected...<br>");
        };

        twitchHub.client.Notify = function (ret) {
            if (ret.data == "1") {
                console.log(ret.message);
                $.amaran({
                    'theme': 'colorful',
                    'content': {
                        bgcolor: '#27ae60',
                        color: '#fff',
                        message: ret.message,
                    },
                    'closeOnClick': false,
                    'inEffect': 'slideTop'
                });
            } else {
                console.log(ret.message);
                $.amaran({
                    'theme': 'colorful',
                    'content': {
                        bgcolor: '#ff3300',
                        color: '#fff',
                        message: ret.message,
                    },
                    'closeOnClick': false,
                    'inEffect': 'slideTop'
                });
            }
        }

        function updateStats(ret) {
            $("#killNr").html(ret.Kills);
            $("#squadNr").html(ret.SquadKills);
            $("#deathNr").html(ret.Deaths);
        }
    })();
</script>
